################################################################################
# Dukira Webhook API - Local Test Log
# Started: 2025-10-02 17:22:23
################################################################################

================================================================================
[2025-10-02 17:22:23] [INFO] Dukira Webhook API - Local Test Execution
================================================================================
[2025-10-02 17:22:23] [INFO] Log file: local_test.log

================================================================================
[2025-10-02 17:22:23] [INFO] Step 1: Checking Prerequisites
================================================================================
[2025-10-02 17:22:23] [SUCCESS] Docker is running and accessible
[2025-10-02 17:22:23] [WARNING] psql client not found - will rely on port checks for verification

================================================================================
[2025-10-02 17:22:23] [INFO] Step 1.5: Starting PostgreSQL and Redis
================================================================================
[2025-10-02 17:22:23] [INFO] Checking PostgreSQL status...
[2025-10-02 17:22:24] [INFO] PostgreSQL container exists. Checking status...
[2025-10-02 17:22:24] [INFO] Starting existing PostgreSQL container...
dukira-postgres
[2025-10-02 17:22:24] [SUCCESS] PostgreSQL container started
[2025-10-02 17:22:27] [INFO] Checking Redis status...
[2025-10-02 17:22:27] [INFO] Redis container exists. Checking status...
[2025-10-02 17:22:27] [INFO] Starting existing Redis container...
dukira-redis
[2025-10-02 17:22:28] [SUCCESS] Redis container started
[2025-10-02 17:22:29] [INFO] Verifying PostgreSQL connection...
[2025-10-02 17:22:29] [WARNING] psql command not available, checking port only...
[2025-10-02 17:22:32] [SUCCESS] PostgreSQL appears to be running on port 5432
[2025-10-02 17:22:32] [INFO] Verifying Redis connection...
[2025-10-02 17:22:32] [SUCCESS] Redis appears to be running on port 6379

================================================================================
[2025-10-02 17:22:32] [INFO] Step 2: Setting Up Python Environment
================================================================================
[2025-10-02 17:22:32] [INFO] Checking Python virtual environment...
[2025-10-02 17:22:32] [WARNING] Virtual environment is not activated
[2025-10-02 17:22:32] [INFO] Found venv directory. Attempting to activate...
[2025-10-02 17:22:32] [SUCCESS] Virtual environment activated: D:\PROJECTS\Dukira_web_hook\venv
[2025-10-02 17:22:32] [INFO] Checking dependencies...
[2025-10-02 17:22:34] [SUCCESS] Dependencies already installed

================================================================================
[2025-10-02 17:22:34] [INFO] Step 3: Setting Up Database
================================================================================
[2025-10-02 17:22:34] [INFO] Checking if database 'dukira_webhook_db' exists...
[2025-10-02 17:22:34] [INFO] Creating database 'dukira_webhook_db'...
./local_test.sh: line 235: psql: command not found
[2025-10-02 17:22:35] [SUCCESS] Database 'dukira_webhook_db' created successfully
[2025-10-02 17:22:35] [INFO] Running database migrations...
FAILED: Path doesn't exist: 'd:\\PROJECTS\\Dukira_web_hook\\alembic'.  Please use the 'init' command to create a new scripts folder.
[2025-10-02 17:22:35] [SUCCESS] Database migrations completed

================================================================================
[2025-10-02 17:22:35] [INFO] Step 4: Starting Services
================================================================================
[2025-10-02 17:22:35] [INFO] Starting FastAPI server on port 8000...
INFO:     Started server process [12592]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-10-02 17:22:39,612 - app.main - ERROR - Database health check failed: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-10-02 17:22:39,651 - app.services.gcs_service - INFO - GCS client initialized for bucket: dukira-web-hook
INFO:     127.0.0.1:55968 - "GET /health HTTP/1.1" 503 Service Unavailable
2025-10-02 17:22:52,657 - app.main - ERROR - Database health check failed: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-10-02 17:22:52,686 - app.services.gcs_service - INFO - GCS client initialized for bucket: dukira-web-hook
INFO:     127.0.0.1:56127 - "GET /health HTTP/1.1" 503 Service Unavailable
2025-10-02 17:26:01,154 - app.main - ERROR - Database health check failed: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-10-02 17:26:01,200 - app.services.gcs_service - INFO - GCS client initialized for bucket: dukira-web-hook
INFO:     127.0.0.1:56699 - "GET /health HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:52731 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:52731 - "GET /openapi.json HTTP/1.1" 200 OK
2025-10-02 17:32:38,645 - app.main - ERROR - Database health check failed: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-10-02 17:32:38,706 - app.services.gcs_service - INFO - GCS client initialized for bucket: dukira-web-hook
INFO:     127.0.0.1:50632 - "GET /health HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:64707 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:64707 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:60683 - "GET /auth/shopify/authorize?shop=dukira-test.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60812 - "GET /auth/shopify/authorize?shop=dukira-test.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58646 - "GET /auth/shopify/authorize?shop=your-store.myshopify.com HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:54828 - "GET /auth/shopify/authorize?shop=your-store.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51049 - "GET /auth/shopify/authorize?shop=dukira-test.myshopify.com HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:59961 - "GET /auth/shopify/authorize?shop=your-store.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56861 - "GET /auth/shopify/authorize?shop=your-store.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54017 - "GET /auth/shopify/authorize?shop=your-store.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64652 - "GET /auth/shopify/authorize?shop=dukira-test.myshopify.com HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:64652 - "GET /auth/shopify/authorize?shop=your-store.myshopify.com&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51593 - "GET /auth/shopify/authorize?shop=dukira-test&user_id=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53344 - "GET /auth/shopify/authorize?shop=dukira-test&user_id=https://dukira-test.myshopify.com/admin/oauth/authorize?client_id=53b313f3c13926fb2e8a157c4762f877&scope=read_products%2Cread_product_listings%2Cwrite_products&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2Fauth%2Fshopify%2Fcallback&state=53b313f3c13926fb2e8a157c4762f877%3AzdkCFZJBK3ngEOGc3WHhAg","state":"53b313f3c13926fb2e8a157c4762f877:zdkCFZJBK3ngEOGc3WHhAg HTTP/1.1" 200 OK
INFO:     127.0.0.1:50902 - "GET /auth/shopify/authorize?shop=dukira-test&user_id=SHOPIFY_CLIENT_ID=53b313f3c13926fb2e8a157c4762f877 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50654 - "GET /products/store/1 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50654 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:64288 - "POST /products/sync/1?job_type=full_sync HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51130 - "GET /auth/shopify/authorize?shop=dukira-test&user_id=test-user-1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60984 - "GET /auth/shopify/authorize?shop=dukira-test&user_id=test-user-1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61260 - "POST /products/sync/1?job_type=full_sync HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:61915 - "GET /auth/shopify/authorize?shop=dukira-test&user_id=test-user-1 HTTP/1.1" 200 OK
